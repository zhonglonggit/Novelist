<table id="mine_data"></table>

<script>
	var obj;
	var editRow=undefined;//记录当前正在被编辑的行
	
	var currentOp;
	var flag;
	
	obj=$('#mine_data').datagrid({    
		    url:'../../adminsServlet',
		    queryParams: {op:'findAllByAid'	},
		    fitColumns:true,
		    striped:true,
		    loadMsg:"数据加载中...",
		    pagination:true,
		    fit:true,
		    pageNumber:1,
		    pageSize:5,
		    pageList:[5,10,15,20,30,3],
		    sortName:'aid',
		    remoteSort:false,
		    columns:[[    
				{field:'aids',title:'',width:100,align:'center',checkbox:true},
		        {field:'aid',title:'编号',width:100,align:'center',sortable:true},    
		        {field:'aname',title:'姓名',width:100,align:'center',editor:{type:"text",options:{requires:true}}}, 
		        {field:'pwd',title:'密码',width:100,align:'center',editor:{type:"text",options:{requires:true}}}
		    ]],
		    toolbar:[{
		    	text:"修改",
		    	iconCls:"icon-edit",
		    	handler:function(){
		    		currentOp="updateAdmins";
		    		flag="修改";
		    		var rows=obj.datagrid("getChecked")[0];
		    		if(rows!=undefined){
		    			if(editRow!=undefined){//说明有行正在被编辑
		    				obj.datagrid("rejectChanges");//回滚所有的数据
			    			obj.datagrid("endEidit",editRow);//关闭正在被编辑的行
			    			editRow=undefined;
		    			}else{
		    				//获取用户选中的行的索引
		    				var index=obj.datagrid("getRowIndex",rows);
		    				alert(rows);
		    				obj.datagrid("updateRow",{index:index,row:rows});
		    				obj.datagrid("beginEdit",index);
		    				editRow=index;//记录当前被编辑的索引行
		    			 	}
		    			}else{
		    				$.messager.show({title:'温馨提示',
		    					msg:'请选中你要修改的数据...',
		    					timeout:2000,
		    					showType:'slide'
		    			});
		    		}
		    	}
		    }]

	});
</script>